{% extends "plotapp/base.html" %}
{% load formatters %}
{% block title %}Extracted Result{% endblock %}

{% block content %}
<div class="card shadow p-4 mb-4">
  <h2 class="text-center mb-4">Extracted Result {{ run_id }}</h2>

  <!-- forward curve plot for selected period -->
  <div class="text-center mb-4">
    <img src="data:image/png;base64,{{ image }}" alt="Forward Curve" class="img-fluid">
  </div>

  <!-- financial metrics for selected period -->
  <h3>Financial Metrics</h3>
  <div class="table-responsive">
    <table class="table table-striped">
      <tbody>
        <tr>
          <th>Total commitment</th>
          <td>{{ financials.total_commitment_hours }} h</td>
        </tr>
        <tr>
          <th>Relative uptime</th>
          <td>{{ financials.relative_uptime_percent|space_thousands }}%</td>
        </tr>
        <tr>
          <th>Total revenue</th>
          <td>BGN {{ financials.total_revenue|space_thousands }}</td>
        </tr>
        <tr>
          <th>Revenue per MWh</th>
          <td>BGN {{ financials.revenue_per_MWh|space_thousands }}</td>
        </tr>
        <tr>
          <th>Total profit</th>
          <td>BGN {{ financials.total_profit|space_thousands }}</td>
        </tr>
        <tr>
          <th>Profit per MWh</th>
          <td>BGN {{ financials.profit_per_MWh|space_thousands }}</td>
        </tr>
        <tr>
          <th>Total expenses</th>
          <td>BGN {{ financials.total_expenses|space_thousands }}</td>
        </tr>
        <tr>
          <th>Expenses per MWh</th>
          <td>BGN {{ financials.expenses_per_MWh|space_thousands }}</td>
        </tr>
        <tr>
          <th>Total coal and CO2 expenses</th>
          <td>BGN {{ financials.coal_co2_expenses|space_thousands }}</td>
        </tr>
        <tr>
          <th>Coal and CO2 expenses per MWh</th>
          <td>BGN {{ financials.coal_co2_per_MWh|space_thousands }}</td>
        </tr>
        <tr>
          <th>Total startups</th>
          <td>{{ financials.total_startups|space_thousands }}</td>
        </tr>
        <tr>
          <th>Startup cost total</th>
          <td>BGN {{ financials.startup_cost_total|space_thousands }}</td>
        </tr>
        <tr>
          <th>Startup cost per MWh</th>
          <td>BGN {{ financials.startup_cost_per_MWh|space_thousands }}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="text-center mt-4">
      <a href="{% url 'download_extracted_zip' run_id=run_id %}?start_date={{ start_date }}&end_date={{ end_date }}" class="btn btn-secondary">Download Extracted Result (ZIP)</a>
      <a href="{% url 'all_results' %}" class="btn btn-secondary">Back to All Results</a>
      <a href="/" class="btn btn-secondary">Upload Another File</a>
  </div>
</div>
{% endblock %}
